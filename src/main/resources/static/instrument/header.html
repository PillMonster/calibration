<!DOCTYPE html>
<head>
    <meta charset="UTF-8">
	 <style>
		table {
		  width: 800px;
		  height: 3px;
		  font-size: 18px;
		}
	 </style>
	<link rel="stylesheet" type="text/css" href="/css/headerStyle.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
</head>
<body>

<!--header id="header"></header-->
<header id="header">
	
	 <div class="dropdown">
		<span id="name"></span>
		<div class="dropdown-content" >
			
			<a>個人資訊</a>
        	<a id="logout-link" href="/calibration/logout?action=logout">登出</a>
	   	</div>
   	</div>
	
   	<nav>
    	<!-- 在這裡放置導航選單 -->
      	<ul>
	        <li><a href="/calibration/instrument/prep">待校驗清單</a></li>
	        <li><a href="/calibration/instrument/crud">器具增刪查改</a></li>
	        <li><a href="/calibration/person/crud">人員增刪查改</a></li>
	        <li class="right"><a href="/calibration/person/login">登入</a></li>
      	</ul>
      	
   	</nav>
   	
</header>

<script type="text/javascript">

	$(document).ready(function() {
		// Send the table data to the server
		$.ajax({
		    type: "GET",
		    url: "/calibration/login/sessionAttributes",
		    dataType:"json",//接收資料格式 (後端需有標註@ResponseBody的方法)
            contentType: "json",
    	    async:true,//true為非同步
            success: function(response) {

                var username = response.userName;
                
                if (username == null) {	
                	
		    	}	
		    	else {
		    		$("#name").text("Welcome, " + username);
		    	}
		    },
		    error: function(xhr, status, error) {
		    	//alert(xhr.responseText);
		    }
	  	}); // ajax method end
	});
	
	 $(document).ready(function() {
         // 给<a>标签绑定点击事件
         $("a#logout-link").click(function(event) {
             event.preventDefault(); // 阻止默认的链接跳转行为
			 console.log($(this).attr("href"));
             // 发送 AJAX 请求
             $.ajax({
                 url: $(this).attr("href"), // 获取链接的href属性作为请求的URL
                 type: "GET", // 请求类型为GET
    
                 success: function(response) {
                	 window.location.href = "/calibration/person/login";
                     // 在这里可以处理成功登出后的逻辑，例如重新导航到登录页面或刷新页面等
                 },
                 error: function(xhr, status, error) {
                     console.log("登出失败:", error);
                     // 处理登出失败的情况
                 }
             });
         });
     });

</script>

</body>
